
{{- $page := . -}}
{{- $page_components := where site.RegularPages "Type" "eq" "page-components" -}}

{{- range .Params.page_sections -}}
    {{- $page_section := . -}}
    {{- range $page_components -}}
        {{- if in . $page_section.page_component -}}
            {{- $poppy_component := printf "poppy-components/%s/%s" .Params.poppy_type .Params.poppy_variant -}}
            {{- if (fileExists (printf "themes/poppygo-one/layouts/partials/%s.html" $poppy_component )) }}
                {{- partial $poppy_component (dict "page" $page "section" $page_section "page_component" .  ) -}}
            {{- end -}}
        {{- end -}}
    {{- end -}}
{{- end -}}




{{/* {{- $page_components := .Site.GetPage "/page_components" -}}

{{- $page := . -}}

{{- range .Params.sections -}}
    {{- $section := . -}}
    {{- range $page_components.Resources.ByType "page" -}}
        {{- if in . $section.page_component -}}
            {{- $poppyComponent := printf "poppy-components/%s/%s" .Params.type .Params.variant -}}
            {{- if (fileExists (printf "themes/poppygo-one/layouts/partials/%s.html" $poppyComponent )) }}
                {{- partial $poppyComponent (dict "page" $page "section" $section "page_component" .  ) -}}
            {{- end -}}
        {{- end -}}
    {{- end -}}
{{- end -}} */}}
